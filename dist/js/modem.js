!function(e){"function"==typeof define&&define.amd?define("modem",["exports","jquery","streamer"],e):"undefined"!=typeof exports&&e(exports,require("jquery"),require("streamer"))}(function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},r=i(t),o=i(n);r.fn.streamer=function(e){return this.each(function(){void 0===r.data(this,"streamer")&&r.data(this,"streamer",new o(this,e))})},r("[data-streamer]").streamer()}),function(e){"function"==typeof define&&define.amd?define("streamer",["exports","module","jquery","streamer/stream","streamer/waveform"],e):"undefined"!=typeof exports&&"undefined"!=typeof module&&e(exports,module,require("jquery"),require("streamer/stream"),require("streamer/waveform"))}(function(e,t,n,i,r){"use strict";var o=function(e){return e&&e.__esModule?e["default"]:e},a=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},s=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},u=o(n),c=o(i),f=o(r),l=function(){function e(t,n){var i=this;s(this,e),this.options=u.extend(this.defaults,n);var r=this.options.classes,o=this.options.icons;this.audio=t,this.$audio=u(this.audio),this.stream=new c(this.audio),this.$audio.wrap(u("<div />",{"class":r.wrapper})),this.$wrapper=this.$audio.parent(),this.$canvas=u("<canvas />"),this.$wrapper.append(this.$canvas),this.$button=u("<button />",{"class":r.button,type:"button"}),this.$wrapper.append(this.$button),this.$icon=u("<span />",{"class":""+r.icon+" "+r.icon+"-play "+o.play}),this.$button.append(this.$icon),this.$button.on("click",function(){i.stream.playing?i.stream.pause():i.stream.play()}),this.stream.bind("play",function(){i.$icon.removeClass(""+r.icon+"-play "+o.play),i.$icon.addClass(""+r.icon+"-pause "+o.pause),i.$wrapper.addClass("is-playing")}),this.stream.bind("pause",function(){i.$icon.removeClass(""+r.icon+"-pause "+o.pause),i.$icon.addClass(""+r.icon+"-play "+o.play),i.$wrapper.removeClass("is-playing")}),this.waveform=new f(this.$canvas[0],this.stream,{stroke:this.options.stroke})}return a(e,null,{defaults:{get:function(){return{stroke:{width:2,color:"#666"},classes:{wrapper:"streamer",button:"streamer-button",icon:"streamer-icon"},icons:{play:"ion-play",pause:"ion-pause"}}},configurable:!0}}),e}();t.exports=l}),function(e){"function"==typeof define&&define.amd?define("streamer/adapter",["exports","module"],e):"undefined"!=typeof exports&&"undefined"!=typeof module&&e(exports,module)}(function(e,t){"use strict";var n=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(){function e(){i(this,e),this.loaded=!1,this.progress=0,this.events={}}return n(e,null,{play:{value:function(){this.playing||(this.playing=!0,this.trigger("play"),this.audio.play())},writable:!0,configurable:!0},pause:{value:function(){this.playing&&(this.playing=!1,this.trigger("pause"),this.audio.pause())},writable:!0,configurable:!0},update:{value:function(){this.trigger("update")},writable:!0,configurable:!0},bind:{value:function(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),this},writable:!0,configurable:!0},unbind:{value:function(e){return this.events[e]&&delete this.events[e],this},writable:!0,configurable:!0},trigger:{value:function(e){return this.events[e]&&this.events[e].forEach(function(e){return e()}),this},writable:!0,configurable:!0}}),e}();t.exports=r}),function(e){"function"==typeof define&&define.amd?define("streamer/stream",["exports","module","streamer/adapter/flash","streamer/adapter/web-audio"],e):"undefined"!=typeof exports&&"undefined"!=typeof module&&e(exports,module,require("streamer/adapter/flash"),require("streamer/adapter/web-audio"))}(function(e,t,n,i){"use strict";var r=function(e){return e&&e.__esModule?e["default"]:e},o=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},s=r(n),u=r(i),c=function(){function e(t){a(this,e),this.audio=new e.Adapter(t)}return o(e,{Adapter:{get:function(){return window.AudioContext?u:s},configurable:!0}},{signal:{get:function(){return this.audio.signal},configurable:!0},playing:{get:function(){return this.audio.playing},configurable:!0},play:{value:function(){this.audio.play()},writable:!0,configurable:!0},pause:{value:function(){this.audio.pause()},writable:!0,configurable:!0},bind:{value:function(e,t){this.audio.bind(e,t)},writable:!0,configurable:!0},unbind:{value:function(e){this.audio.unbind(e)},writable:!0,configurable:!0},trigger:{value:function(e){this.audio.trigger(e)},writable:!0,configurable:!0}}),e}();t.exports=c}),function(e){"function"==typeof define&&define.amd?define("streamer/waveform",["exports","module","jquery"],e):"undefined"!=typeof exports&&"undefined"!=typeof module&&e(exports,module,require("jquery"))}(function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},r=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=i(n),s=function(){function e(t,n,i){var r=this;o(this,e);var s=this.ratio(t),u=function(){r.draw(n.signal,t,s,i)},c=function(){r.scale(t,s),u()};c(),a(window).on("resize",function(){return c()}),n.bind("update",function(){return u()})}return r(e,null,{ratio:{value:function(e){var t=e.getContext("2d"),n=window.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i},writable:!0,configurable:!0},scale:{value:function(e,t){var n=e.getContext("2d"),i=a(e);if(1!==t){var r=i.width(),o=i.height();e.width=r*t,e.height=o*t,n.scale(t,t)}},writable:!0,configurable:!0},draw:{value:function(e,t,n,i){var r=t.getContext("2d"),o=t.width,a=t.height,s=n;i=i||{},r.lineWidth=i.stroke.width,r.strokeStyle=i.stroke.color,r.clearRect(0,0,o,a),r.beginPath();for(var u=0,c=e.length;c>u;u++)r.lineTo(u*(o/c),a/(2*s)+e[u]*(a/(2*s)));r.stroke(),r.closePath()},writable:!0,configurable:!0}}),e}();t.exports=s}),function(e){"function"==typeof define&&define.amd?define("streamer/adapter/flash",["exports","module","jquery","streamer/adapter"],e):"undefined"!=typeof exports&&"undefined"!=typeof module&&e(exports,module,require("jquery"),require("streamer/adapter"))}(function(e,t,n,i){"use strict";var r=function(e){return e&&e.__esModule?e["default"]:e},o=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},a=function d(e,t,n){var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:d(r,t,n)}if("value"in i&&i.writable)return i.value;var o=i.get;return void 0===o?void 0:o.call(n)},s=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},u=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},c=r(n),f=r(i),l=function(e){function t(e){var n=this;u(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.source=e;var i=this.source.src||c(this.source).find("source[src$=mp3], source[src$=mp4], source[src$=m4a]")[0].src;this.wave_L=[],this.wave_R=[],this.signal=new Float32Array(this.sampleSize),t.loadSoundManager(function(){n.audio=t.soundManager.createSound({url:i,stream:!0,autoLoad:!0,whileplaying:function(){n.update()},whileloading:function(){n.progress=n.bytesLoaded/n.bytesTotal},onload:function(){n.loaded=!0,n.progress=1,n.trigger("loaded")},onplay:function(){return n.play()},onresume:function(){return n.play()},onpause:function(){return n.pause()},onfinish:function(){return n.pause()}})})}return s(t,e),o(t,{soundManagerPath:{get:function(){return{js:"lib/soundmanager2.js",swf:"lib/soundmanager2.swf"}},configurable:!0},loadSoundManager:{value:function(e){window.SM2_DEFER=!0,c.ajax({dataType:"script",cache:!0,url:t.soundManagerPath.js,success:function(){require(["SoundManager"],function(n){var i=n.SoundManager;t.soundManager||(t.soundManager=new i,c.extend(!0,t.soundManager,{flashVersion:9,flash9Options:{useWaveformData:!0},preferFlash:!0,useHTML5Audio:!1,useWaveformData:!0,useHighPerformance:!0,useFastPolling:!0,multiShot:!1,debugMode:!1,debugFlash:!1,url:t.soundManagerPath.swf}),t.soundManager.beginDelayedInit()),window.soundManager=t.soundManager,t.soundManager.onready(function(){return e()})})}})},writable:!0,configurable:!0}},{sampleSize:{get:function(){return 1024},configurable:!0},sampleRate:{get:function(){return 44100},configurable:!0},update:{value:function(){if(this.loaded||this.playing){this.wave_L=this.audio.waveformData.left,this.wave_R=this.audio.waveformData.right;for(var e=void 0,n=0,i=this.wave_L.length;i>n;n++)e=parseFloat(this.wave_L[n])+parseFloat(this.wave_R[n]),this.signal[2*n]=e/2,this.signal[2*n+1]=e/2;a(Object.getPrototypeOf(t.prototype),"update",this).call(this)}},writable:!0,configurable:!0}}),t}(f);t.exports=l}),function(e){"function"==typeof define&&define.amd?define("streamer/adapter/web-audio",["exports","module","streamer/adapter"],e):"undefined"!=typeof exports&&"undefined"!=typeof module&&e(exports,module,require("streamer/adapter"))}(function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},r=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},o=function f(e,t,n){var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:f(r,t,n)}if("value"in i&&i.writable)return i.value;var o=i.get;return void 0===o?void 0:o.call(n)},a=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},s=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},u=i(n),c=function(e){function t(e){var n=this;s(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var i=window.AudioContext;this.context=new i,this.audio=e,this.context.createScriptProcessor||(this.context.createScriptProcessor=this.context.createJavascriptNode),this.processor=this.context.createScriptProcessor(this.sampleSize/2,1,1),this.processor.onaudioprocess=function(e){return n.update(e)},this.context.createGain||(this.context.createGain=this.context.createGainNode),this.gain=this.context.createGain(),this.signal=new Float32Array(this.sampleSize/2),this.audio.readyState<3?this.audio.oncanplay=function(){return n.connect()}:this.connect(),this.audio.onprogress=function(e){var t=e.currentTarget;t.duration&&(n.progress=t.seekable.end(0)/t.duration)},this.audio.onplaying=function(){return n.play()},this.audio.onpause=function(){return n.pause()}}return a(t,e),r(t,null,{sampleSize:{get:function(){return 2048},configurable:!0},update:{value:function(e){var n=this;if(this.loaded&&this.playing){for(var i=[],r=e.inputBuffer.numberOfChannels,a=this.sampleSize/r,s=r;s--;)i.push(e.inputBuffer.getChannelData(s));for(var s=0;a>s;s++)!function(e){n.signal[e]=r>1?i.reduce(function(t,n){return t[e]+n[e]})/r:i[0][e]}(s);o(Object.getPrototypeOf(t.prototype),"update",this).call(this)}},writable:!0,configurable:!0},connect:{value:function(){this.source=this.context.createMediaElementSource(this.audio),this.source.connect(this.processor),this.source.connect(this.gain),this.gain.connect(this.context.destination),this.processor.connect(this.context.destination),this.loaded=!0,this.progress=1,this.trigger("loaded")},writable:!0,configurable:!0}}),t}(u);t.exports=c});
//# sourceMappingURL=modem.js.map