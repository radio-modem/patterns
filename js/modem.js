"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();define("modem",["jquery"],function(t){t="default"in t?t["default"]:t;var e=function(){function t(e){var i=this;_classCallCheck(this,t),this.loaded=!1,this.events={};var n=window.AudioContext||window.webkitAudioContext;this.context=new n,this.audio=e,this.context.createScriptProcessor||(this.context.createScriptProcessor=this.context.createJavascriptNode),this.processor=this.context.createScriptProcessor(this.sampleSize/2,1,1),this.processor.onaudioprocess=function(t){return i.update(t)},this.context.createGain||(this.context.createGain=this.context.createGainNode),this.gain=this.context.createGain(),this.signal=new Float32Array(this.sampleSize/2),this.audio.readyState<3?this.audio.oncanplay=function(){return i.connect()}:this.connect(),this.audio.onplaying=function(){return i.play()},this.audio.onpause=function(){return i.pause()}}return _createClass(t,[{key:"sampleSize",get:function(){return 2048}}]),_createClass(t,[{key:"update",value:function(t){var e=this;if(this.loaded&&this.playing){for(var i=[],n=t.inputBuffer.numberOfChannels,s=this.sampleSize/n,a=n-1;a>=0;a--)i.push(t.inputBuffer.getChannelData(a));for(var o=function(t){n>1?e.signal[t]=i.reduce(function(e,i){return e[t]+i[t]})/n:e.signal[t]=i[0][t]},r=0;r<s;r++)o(r);this.trigger("update")}}},{key:"connect",value:function(){this.source=this.context.createMediaElementSource(this.audio),this.source.connect(this.processor),this.source.connect(this.gain),this.gain.connect(this.context.destination),this.processor.connect(this.context.destination),this.loaded=!0,this.trigger("loaded")}},{key:"play",value:function(){!this.playing&&this.audio&&(this.playing=!0,this.trigger("play"),this.audio.play())}},{key:"pause",value:function(){this.playing&&this.audio&&(this.playing=!1,this.trigger("pause"),this.audio.pause())}},{key:"bind",value:function(t,e){return this.events[t]||(this.events[t]=[]),this.events[t].push(e),this}},{key:"unbind",value:function(t){return this.events[t]&&Reflect.deleteProperty(this.events[t]),this}},{key:"trigger",value:function(t){return this.events[t]&&this.events[t].forEach(function(t){return t()}),this}}]),t}(),i=function(){function e(i,n,s){var a=this;_classCallCheck(this,e),this.options=t.extend(e.defaults,s);var o=this.ratio(i),r=function(){a.draw(n.signal,i,o)},c=function(){a.scale(i,o),r()};c(),t(window).on("resize",function(){return c()}),n.bind("update",function(){return r()})}return _createClass(e,null,[{key:"defaults",get:function(){return{stroke:{width:2,color:"#666"}}}}]),_createClass(e,[{key:"ratio",value:function(t){var e=t.getContext("2d"),i=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return i/n}},{key:"scale",value:function(e,i){var n=e.getContext("2d"),s=t(e);if(1!==i){var a=s.width(),o=s.height();e.width=a*i,e.height=o*i,n.scale(i,i)}}},{key:"draw",value:function(t,e,i){var n=e.getContext("2d"),s=e.width,a=e.height,o=i,r=t.length;n.lineWidth=this.options.stroke.width,n.strokeStyle=this.options.stroke.color,n.clearRect(0,0,s,a),n.beginPath();for(var c=0;c<r;c++)n.lineTo(c*(s/r),a/(2*o)+t[c]*(a/(2*o)));n.stroke(),n.closePath()}}]),e}(),n=function(){function n(s,a){var o=this;_classCallCheck(this,n),this.options=t.extend(n.defaults,a),s.addEventListener("error",function(t){return o.onError(t)},!0),s.load();var r=this.options,c=r.classes,l=r.icons,u=r.labels;this.audio=new e(s),this.$audio=t(s),this.$audio.wrap(t("<div />",{"class":c.wrapper})),this.$wrapper=this.$audio.parent(),this.$canvas=t("<canvas />"),this.$wrapper.append(this.$canvas),this.$button=t("<button />",{"class":c.button,type:"button","aria-label":u.play}),this.$wrapper.append(this.$button),this.$icon=t("<span />",{"class":c.icon+" "+c.icon+"-play "+l.play}),this.$button.append(this.$icon),this.audio.bind("play",function(){return o.onPlay()}),this.audio.bind("pause",function(){return o.onPause()}),this.$button.on("click",function(){return o.onButtonClick()}),s.autoplay&&this.audio.play(),this.waveform=new i(this.$canvas[0],this.audio,this.options.waveform)}return _createClass(n,null,[{key:"defaults",get:function(){return{classes:{wrapper:"streamer",button:"streamer-button",icon:"streamer-icon"},icons:{play:"ion-play",pause:"ion-pause",offline:"ion-android-microphone-off"},labels:{play:"Continue playing",pause:"Stop playing",offline:"Stream offline"}}}}]),_createClass(n,[{key:"onPlay",value:function(){if(!this.offline){var t=this.options,e=t.labels,i=t.icons,n=t.classes;this.$button.attr("aria-label",e.pause),this.$icon.removeClass(n.icon+"-play "+i.play),this.$icon.addClass(n.icon+"-pause "+i.pause),this.$wrapper.addClass("is-playing")}}},{key:"onPause",value:function(){if(!this.offline){var t=this.options,e=t.labels,i=t.icons,n=t.classes;this.$button.attr("aria-label",e.play),this.$icon.removeClass(n.icon+"-pause "+i.pause),this.$icon.addClass(n.icon+"-play "+i.play),this.$wrapper.removeClass("is-playing")}}},{key:"onButtonClick",value:function(){this.offline||(this.audio.playing?this.audio.pause():this.audio.play())}},{key:"onError",value:function(){this.offline=!0,this.audio.pause();var t=this.options,e=t.labels,i=t.icons,n=t.classes;this.$button.attr("aria-label",e.offline),this.$icon.removeClass(n.icon+"-pause "+i.pause),this.$icon.removeClass(n.icon+"-play "+i.play),this.$icon.addClass(n.icon+"-offline "+i.offline),this.$wrapper.removeClass("is-playing")}}]),n}(),s=function(){function e(i,n){var s=this;_classCallCheck(this,e),this.options=t.extend(e.defaults,n),this.$element=t(i);var a=this.options.classes,o=this.$element.find("[data-slide-in-close]"),r=t("[data-slide-in-toggle="+this.$element.attr("id")+"]");r.on("click",function(){s.$element.hasClass(a.open)?s.hide():s.show()}),o.on("click",function(){s.$element.hasClass(a.open)?s.hide():s.show()})}return _createClass(e,null,[{key:"defaults",get:function(){return{classes:{open:"is-open"}}}}]),_createClass(e,[{key:"show",value:function(){this.$element.addClass(this.options.classes.open)}},{key:"hide",value:function(){this.$element.removeClass(this.options.classes.open)}}]),e}();t.fn.streamer=function(e){return this.each(function(i,s){void 0===t.data(s,"streamer")&&t.data(s,"streamer",new n(s,e))})},t("[data-streamer]").streamer(),t.fn.slideIn=function(e){return this.each(function(i,n){void 0===t.data(n,"slide-in")&&t.data(n,"slide-in",new s(n,e))})},t("[data-slide-in]").slideIn()});var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();define("modem",["jquery"],function(t){t="default"in t?t["default"]:t;var e=function(){function e(i,n){var s=this;_classCallCheck(this,e),this.options=t.extend(e.defaults,n),this.$element=t(i);var a=this.options.classes,o=this.$element.find("[data-slide-in-close]"),r=t("[data-slide-in-toggle="+this.$element.attr("id")+"]");r.on("click",function(){s.$element.hasClass(a.open)?s.hide():s.show()}),o.on("click",function(){s.$element.hasClass(a.open)?s.hide():s.show()})}return _createClass(e,null,[{key:"defaults",get:function(){return{classes:{open:"is-open"}}}}]),_createClass(e,[{key:"show",value:function(){this.$element.addClass(this.options.classes.open)}},{key:"hide",value:function(){this.$element.removeClass(this.options.classes.open)}}]),e}();return e});var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();define("modem",["jquery"],function(t){t="default"in t?t["default"]:t;var e=function(){function t(e){var i=this;_classCallCheck(this,t),this.loaded=!1,this.events={};var n=window.AudioContext||window.webkitAudioContext;this.context=new n,this.audio=e,this.context.createScriptProcessor||(this.context.createScriptProcessor=this.context.createJavascriptNode),this.processor=this.context.createScriptProcessor(this.sampleSize/2,1,1),this.processor.onaudioprocess=function(t){return i.update(t)},this.context.createGain||(this.context.createGain=this.context.createGainNode),this.gain=this.context.createGain(),this.signal=new Float32Array(this.sampleSize/2),this.audio.readyState<3?this.audio.oncanplay=function(){return i.connect()}:this.connect(),this.audio.onplaying=function(){return i.play()},this.audio.onpause=function(){return i.pause()}}return _createClass(t,[{key:"sampleSize",get:function(){return 2048}}]),_createClass(t,[{key:"update",value:function(t){var e=this;if(this.loaded&&this.playing){for(var i=[],n=t.inputBuffer.numberOfChannels,s=this.sampleSize/n,a=n-1;a>=0;a--)i.push(t.inputBuffer.getChannelData(a));for(var o=function(t){n>1?e.signal[t]=i.reduce(function(e,i){return e[t]+i[t]})/n:e.signal[t]=i[0][t]},r=0;r<s;r++)o(r);this.trigger("update")}}},{key:"connect",value:function(){this.source=this.context.createMediaElementSource(this.audio),this.source.connect(this.processor),this.source.connect(this.gain),this.gain.connect(this.context.destination),this.processor.connect(this.context.destination),this.loaded=!0,this.trigger("loaded")}},{key:"play",value:function(){!this.playing&&this.audio&&(this.playing=!0,this.trigger("play"),this.audio.play())}},{key:"pause",value:function(){this.playing&&this.audio&&(this.playing=!1,this.trigger("pause"),this.audio.pause())}},{key:"bind",value:function(t,e){return this.events[t]||(this.events[t]=[]),this.events[t].push(e),this}},{key:"unbind",value:function(t){return this.events[t]&&Reflect.deleteProperty(this.events[t]),this}},{key:"trigger",value:function(t){return this.events[t]&&this.events[t].forEach(function(t){return t()}),this}}]),t}(),i=function(){function e(i,n,s){var a=this;_classCallCheck(this,e),this.options=t.extend(e.defaults,s);var o=this.ratio(i),r=function(){a.draw(n.signal,i,o)},c=function(){a.scale(i,o),r()};c(),t(window).on("resize",function(){return c()}),n.bind("update",function(){return r()})}return _createClass(e,null,[{key:"defaults",get:function(){return{stroke:{width:2,color:"#666"}}}}]),_createClass(e,[{key:"ratio",value:function(t){var e=t.getContext("2d"),i=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return i/n}},{key:"scale",value:function(e,i){var n=e.getContext("2d"),s=t(e);if(1!==i){var a=s.width(),o=s.height();e.width=a*i,e.height=o*i,n.scale(i,i)}}},{key:"draw",value:function(t,e,i){var n=e.getContext("2d"),s=e.width,a=e.height,o=i,r=t.length;n.lineWidth=this.options.stroke.width,n.strokeStyle=this.options.stroke.color,n.clearRect(0,0,s,a),n.beginPath();for(var c=0;c<r;c++)n.lineTo(c*(s/r),a/(2*o)+t[c]*(a/(2*o)));n.stroke(),n.closePath()}}]),e}(),n=function(){function n(s,a){var o=this;_classCallCheck(this,n),this.options=t.extend(n.defaults,a),s.addEventListener("error",function(t){return o.onError(t)},!0),s.load();var r=this.options,c=r.classes,l=r.icons,u=r.labels;this.audio=new e(s),this.$audio=t(s),this.$audio.wrap(t("<div />",{"class":c.wrapper})),this.$wrapper=this.$audio.parent(),this.$canvas=t("<canvas />"),this.$wrapper.append(this.$canvas),this.$button=t("<button />",{"class":c.button,type:"button","aria-label":u.play}),this.$wrapper.append(this.$button),this.$icon=t("<span />",{"class":c.icon+" "+c.icon+"-play "+l.play}),this.$button.append(this.$icon),this.audio.bind("play",function(){return o.onPlay()}),this.audio.bind("pause",function(){return o.onPause()}),this.$button.on("click",function(){return o.onButtonClick()}),s.autoplay&&this.audio.play(),this.waveform=new i(this.$canvas[0],this.audio,this.options.waveform)}return _createClass(n,null,[{key:"defaults",get:function(){return{classes:{wrapper:"streamer",button:"streamer-button",icon:"streamer-icon"},icons:{play:"ion-play",pause:"ion-pause",offline:"ion-android-microphone-off"},labels:{play:"Continue playing",pause:"Stop playing",offline:"Stream offline"}}}}]),_createClass(n,[{key:"onPlay",value:function(){if(!this.offline){var t=this.options,e=t.labels,i=t.icons,n=t.classes;this.$button.attr("aria-label",e.pause),this.$icon.removeClass(n.icon+"-play "+i.play),this.$icon.addClass(n.icon+"-pause "+i.pause),this.$wrapper.addClass("is-playing")}}},{key:"onPause",value:function(){if(!this.offline){var t=this.options,e=t.labels,i=t.icons,n=t.classes;this.$button.attr("aria-label",e.play),this.$icon.removeClass(n.icon+"-pause "+i.pause),this.$icon.addClass(n.icon+"-play "+i.play),this.$wrapper.removeClass("is-playing")}}},{key:"onButtonClick",value:function(){this.offline||(this.audio.playing?this.audio.pause():this.audio.play())}},{key:"onError",value:function(){this.offline=!0,this.audio.pause();var t=this.options,e=t.labels,i=t.icons,n=t.classes;this.$button.attr("aria-label",e.offline),this.$icon.removeClass(n.icon+"-pause "+i.pause),this.$icon.removeClass(n.icon+"-play "+i.play),this.$icon.addClass(n.icon+"-offline "+i.offline),this.$wrapper.removeClass("is-playing")}}]),n}();return n});var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();define("modem",["jquery"],function(t){t="default"in t?t["default"]:t;var e=function(){function e(i,n,s){var a=this;_classCallCheck(this,e),this.options=t.extend(e.defaults,s);var o=this.ratio(i),r=function(){a.draw(n.signal,i,o)},c=function(){a.scale(i,o),r()};c(),t(window).on("resize",function(){return c()}),n.bind("update",function(){return r()})}return _createClass(e,null,[{key:"defaults",get:function(){return{stroke:{width:2,color:"#666"}}}}]),_createClass(e,[{key:"ratio",value:function(t){var e=t.getContext("2d"),i=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return i/n}},{key:"scale",value:function(e,i){var n=e.getContext("2d"),s=t(e);if(1!==i){var a=s.width(),o=s.height();e.width=a*i,e.height=o*i,n.scale(i,i)}}},{key:"draw",value:function(t,e,i){var n=e.getContext("2d"),s=e.width,a=e.height,o=i,r=t.length;n.lineWidth=this.options.stroke.width,n.strokeStyle=this.options.stroke.color,n.clearRect(0,0,s,a),n.beginPath();for(var c=0;c<r;c++)n.lineTo(c*(s/r),a/(2*o)+t[c]*(a/(2*o)));n.stroke(),n.closePath()}}]),e}();return e});var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();define("modem",function(){var t=function(){function t(e){var i=this;_classCallCheck(this,t),this.loaded=!1,this.events={};var n=window.AudioContext||window.webkitAudioContext;this.context=new n,this.audio=e,this.context.createScriptProcessor||(this.context.createScriptProcessor=this.context.createJavascriptNode),this.processor=this.context.createScriptProcessor(this.sampleSize/2,1,1),this.processor.onaudioprocess=function(t){return i.update(t)},this.context.createGain||(this.context.createGain=this.context.createGainNode),this.gain=this.context.createGain(),this.signal=new Float32Array(this.sampleSize/2),this.audio.readyState<3?this.audio.oncanplay=function(){return i.connect()}:this.connect(),this.audio.onplaying=function(){return i.play()},this.audio.onpause=function(){return i.pause()}}return _createClass(t,[{key:"sampleSize",get:function(){return 2048}}]),_createClass(t,[{key:"update",value:function(t){var e=this;if(this.loaded&&this.playing){for(var i=[],n=t.inputBuffer.numberOfChannels,s=this.sampleSize/n,a=n-1;a>=0;a--)i.push(t.inputBuffer.getChannelData(a));for(var o=function(t){n>1?e.signal[t]=i.reduce(function(e,i){return e[t]+i[t]})/n:e.signal[t]=i[0][t]},r=0;r<s;r++)o(r);this.trigger("update")}}},{key:"connect",value:function(){this.source=this.context.createMediaElementSource(this.audio),this.source.connect(this.processor),this.source.connect(this.gain),this.gain.connect(this.context.destination),this.processor.connect(this.context.destination),this.loaded=!0,this.trigger("loaded")}},{key:"play",value:function(){!this.playing&&this.audio&&(this.playing=!0,this.trigger("play"),this.audio.play())}},{key:"pause",value:function(){this.playing&&this.audio&&(this.playing=!1,this.trigger("pause"),this.audio.pause())}},{key:"bind",value:function(t,e){return this.events[t]||(this.events[t]=[]),this.events[t].push(e),this}},{key:"unbind",value:function(t){return this.events[t]&&Reflect.deleteProperty(this.events[t]),this}},{key:"trigger",value:function(t){return this.events[t]&&this.events[t].forEach(function(t){return t()}),this}}]),t}();return t});
//# sourceMappingURL=modem.js.map
